<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="style.css" type="text/css">

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <title>Thesis Repository</title>
  </head>


  <body>
                 <nav class="navbar navbar-expand-lg navbar-light navbar-custom ">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="diary.html">Diary</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="phases.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Phases
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="phase1.html">Phase 1</a>
          <a class="dropdown-item" href="phase2.html">Phase 2</a>
          <a class="dropdown-item" href="phase3.html">Phase 3</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="meetings.html">Meetings</a>
      </li>
    </ul>
  </div>
</nav>


    <h1>Diary</h1>
      <div id="accordion">

  <div class="card">
    <div class="card-header" id="headingOne">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Week #1 (01-14-20)
        </button>
      </h5>
    </div>

    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">
        <h2>UnitTest Introduction</h2>
        <p>UnitTest is a test runner built into a python library, containing both a testing framework and a test runner.</p>
        <p><em>Requirements:</em></p>
        <ul>
          <li>tests must be included into <em>classes</em> as <em>methods</em> </li>
          <li>instead of the built-in statement "assert", the <em>special assertion methods in unittest.TestCase class </em> must be used </li>
        </ul>
      
      <h2>Example 1</h2>
      <p>file test_sum_2.py</p>
      <div class="codebg">
        <code>
          <pre>
def test_sum():
    assert sum([1, 2, 3]) == 6, "Should be 6"

def test_sum_tuple():
    assert sum((1, 2, 2)) == 6, "Should be 6"

if __name__ == "__main__":
    test_sum()
    test_sum_tuple()
    print("Everything passed")
          </pre>
        </code>
      </div>
  <p>Steps of the procedure to convert the aforementioned example into a unittest case:</p>
  <ol>
    <li> <em>import unittest</em> from the library</li>
    <li>create a <em>TestSum class</em>, inherited from TestCase class</li>
    <li>use <em>self</em> as first argument, so that functions are turned into methods</li>
    <li>change assertions, so to use <em>self.assertEqual() method from the TestCase class</em></li>
    <li>change the command-line entry point to call unittest.main()</li>
  </ol>
  <div class="container">
    <img src="unittest1.png" alt="unittest1">

  </div>
    <div class="info"><p><span class="remind">assert</span><br>The assert keyword lets you test if a condition in your code returns True, if not, the program will raise an AssertionError.

You can write a message to be written if the code returns False</p>
      <div class="codebg">
        <code><pre>
x = "hello"

#if condition returns True, then nothing happens:
assert x == "hello"

#if condition returns False, AssertionError is raised:
assert x == "goodbye"
        </pre></code></div>
        <p>Source: <a href="https://www.w3schools.com/python/ref_keyword_assert.asp#:~:text=The%20assert%20keyword%20is%20used,False%2C%20check%20the%20example%20below.">w3school.com</a></p>
      </div>
    <p>Source:<a href="https://realpython.com/python-testing/">realpython.com</a></p>
    <h2>Example 2</h2>
    <div class="codebg">
      <code>
        <pre>
          import unittest

          def add_fish_to_aquarium(fish_list):
              if len(fish_list) > 10:
                  raise ValueError("A maximum of 10 fish can be added to the aquarium")
              return {"tank_a": fish_list}


          class TestAddFishToAquarium(unittest.TestCase):
              def test_add_fish_to_aquarium_success(self):
                  actual = add_fish_to_aquarium(fish_list=["shark", "tuna"])
                  expected = {"tank_a": ["shark", "tuna"]}
                  self.assertEqual(actual, expected)
        </pre>
      </code>
    </div>
    <p>Procedure:</p>
    <ol>
      <li>Import unittest</li>
      <li>Define the function to test, defining also cases in which the function raises errors</li>
      <li>Define a class as a subclass of unittest.TestCase</li>
      <li>Define one or more methods of the defined class (with self argument). This test function calls the function to test with a specific input and verifies whether the actual returned value matches the expected one</li>
      <li>Execute the test (from command line: python -m unittest test_add_fish_to_aquarium.py)</li>
    </ol>
    <p>Source <a href="https://www.digitalocean.com/community/tutorials/how-to-use-unittest-to-write-a-test-case-for-a-function-in-python">https://www.digitalocean.com/</a></p>
    <h2>Example 3</h2>
    <div class="codebg">
      <code>
        <pre>
          import unittest

          class TestStringMethods(unittest.TestCase):

              def test_upper(self):
                  self.assertEqual('foo'.upper(), 'FOO')

              def test_isupper(self):
                  self.assertTrue('FOO'.isupper())
                  self.assertFalse('Foo'.isupper())

              def test_split(self):
                  s = 'hello world'
                  self.assertEqual(s.split(), ['hello', 'world'])
                  # check that s.split fails when the separator is not a string
                  with self.assertRaises(TypeError):
                      s.split(2)

          if __name__ == '__main__':
              unittest.main()
        </pre>
      </code>
    </div>
    <p>Procedure:</p>
    <ul>
      <li>import unittest</li>
      <li>a testcase is created by subclassing unittest.TestCase.</li>
      <li>individual tests are defined with methods whose names start with the letters test, in order to inform the test runner about which methods represent tests.</li>
      <li>each test is a call to assertEqual() to check for an expected result; assertTrue() or assertFalse() to verify a condition; or assertRaises() to verify that a specific exception gets raised. Differently from the simple assert statement, these methods allow the test runner to accumulate all test results and produce a report.</li>
      <li>setUp() and tearDown() methods allow you to define instructions that will be executed before and after each test method.</li>
      <li>unittest.main() is a simple way to run the tests. Provides a command-line interface to the test script. </li>
      <li>Passing the -v option to your test script will instruct unittest.main() to enable a higher level of verbosity, so that each test's outcome can be seen individually.</li>
      <div class="container">
        <img src="prompt.png" alt="promptscreenshot">
      </div>
    </ul>
    <p>Source <a href="https://docs.python.org/3/library/unittest.html">unittest documentation</a></p>

    <h2>Classes and functions</h2>
    <div class="info"><span class="remind">tearDown()</span><br>
      <p>Method called immediately after the test method has been called and the result recorded. This is called even if the test method raised an exception, so the implementation in subclasses may need to be particularly careful about checking internal state. This method will only be called if the setUp() succeeds, regardless of the outcome of the test method.</p>
      </div>

    <div class="info"><span class="remind">setUp()</span><br>
      <p>Method called to prepare the test fixture. This is called immediately before calling the test method; other than AssertionError or SkipTest, any exception raised by this method will be considered an error rather than a test failure. </p>
      </div>

    <div class="info"><span class="remind">assertEqual(first, second, msg=None)</span><br>
      <p>Test that first and second are not equal. If the values do compare equal, the test will fail. </p>
      </div>

    <div class="info"><span class="remind">assertNotEqual(first, second, msg=None)</span><br>
      <p>Test that first and second are not equal. If the values do compare equal, the test will fail. </p>
      </div>

    <div class="info"><span class="remind">assertTrue(expr, second, msg=None) & assertFalse(expr, second, msg=None)</span><br>
      <p>Test that expr is true (or false). </p>
      </div>

    <div class="info"><span class="remind">assertIs(first, second, msg=None) & assertIsNot(first, second, msg=None)</span><br>
      <p>Test that first and second are (or are not) the same object. </p>
      </div>

    <div class="info"><span class="remind">assertIsNone(expr, msg=None) & assertIsNotNone(expr, msg=None)</span><br>
      <p>Test that expr is (or is not) None </p>
    </div>

    <div class="info"><span class="remind">assertIn(member, container, msg=None) & assertNotIn(member, container, msg=None)</span><br>
      <p>Test that member is (or is not) in container.</p>
      </div>

    <div class="info"><span class="remind">assertIsInstance(obj, cls, msg=None) & assertNotIsInstance(obj, cls, msg=None)</span><br>
      <p>Test that obj is (or is not) an instance of cls (which can be a class or a tuple of classes, as supported by isinstance()). To check for the exact type, use assertIs(type(obj), cls). </p>
      </div>

    <div class="info"><span class="remind">assertCountEqual(first, second, msg=None)</span><br>
      <p>Test that sequence first contains the same elements as second, regardless of their order.  </p>
      </div>

    <div class="info"><span class="remind">assertMultiLineEqual(first, second, msg=None)</span><br>
      <p>Test that the multiline string first is equal to the string second. </p>
      </div>

    <div class="info"><span class="remind">assertListEqual(first, second, msg=None) & assertTupleEqual(first, second, msg=None)</span><br>
      <p>Tests that two lists or tuples are equal. If not, an error message is constructed that shows only the differences between the two.</p>
      </div>

    <div class="info"><span class="remind">assertSetEqual(first, second, msg=None)</span><br>
      <p>Tests that two sets are equal. If not, an error message is constructed that lists the differences between the sets. This method is used by default when comparing sets or frozensets with assertEqual().</p>
      </div>

    <div class="info"><span class="remind">assertDictEqual(first, second, msg=None)</span><br>
      <p>Test that two dictionaries are equal. If not, an error message is constructed that shows the differences in the dictionaries. This method will be used by default to compare dictionaries in calls to assertEqual().</p>
      </div>

    <div class="info"><span class="remind">assertListEqual(first, second, msg=None) & assertTupleEqual(first, second, msg=None)</span><br>
      <p>Tests that two lists or tuples are equal. If not, an error message is constructed that shows only the differences between the two.</p>
      </div>

    <p>Source <a href="https://docs.python.org/3/library/unittest.html">unittest documentation</a></p>

    <h2>Organizing test code</h2>
    <ul>
      <li>In unittest, test cases are unittest.TestCase instances.</li>
      <li>The testing code of a TestCase instance should be entirely self contained, in order to be runnable either in isolation or in combination</li>
      <li>In order to test, the assert*() methods provided by the TestCase base class are used. When the test fails, an exception is raised with an explanatory message, and unittest identifies the test case as a failure.</li>
      <li>When many tests with repetitive set ups have to be executed, setUP() method can be automatically called for every test run. </li>
      <li>tearDown() method, similarly, tidies up after the test method has been run</li>
      <li>Such a working environment for the testing code is called a test fixture. A new TestCase instance is created as a unique test fixture used to execute each individual test method. Thus setUp(), tearDown(), and __init__() will be called once per test.</li>
      <li>Test suite, represented by unittest’s TestSuite class, is a mechanism to group TestCase implementations according to the features they test.</li>
    </ul>
    <p>Source <a href="https://docs.python.org/3/library/unittest.html">unittest documentation</a></p>

    <h2>Reusing old test code</h2>
    <p>FunctionTestCase class: TestCase subclass to wrap an existing test function. </p>
    <div class="codebg">
      <code>
        <pre>
          testcase = unittest.FunctionTestCase(testSomething,
                                     setUp=makeSomethingDB,
                                     tearDown=deleteSomethingDB)
        </pre>
      </code>

    </div>
    <p>Source <a href="https://docs.python.org/3/library/unittest.html">unittest documentation</a></p>

    <h2>index/test/09_croci.py/</h2>
    <div class="codebg">
      <code>
        <pre>
          import unittest
          from index.coci.glob import process
          from os import sep, makedirs
          from os.path import exists
          from shutil import rmtree
          from index.storer.csvmanager import CSVManager
          from index.croci.crowdsourcedcitationsource import CrowdsourcedCitationSource
          from csv import DictReader


          class CROCITest(unittest.TestCase):

              def setUp(self):
                  self.input_file = "index%stest_data%scroci_dump%ssource.csv" % (sep, sep, sep)
                  self.citations = "index%stest_data%scroci_dump%scitations.csv" % (sep, sep, sep)

              def test_citation_source(self):
                  ccs = CrowdsourcedCitationSource(self.input_file)
                  new = []
                  cit = ccs.get_next_citation_data()
                  while cit is not None:
                      citing, cited, creation, timespan, journal_sc, author_sc = cit
                      new.append({
                          "citing": citing,
                          "cited": cited,
                          "creation": "" if creation is None else creation,
                          "timespan": "" if timespan is None else timespan,
                          "journal_sc": "no" if journal_sc is None else journal_sc,
                          "author_sc": "no" if author_sc is None else author_sc
                      })
                      cit = ccs.get_next_citation_data()

                  with open(self.citations) as f:
                      old = list(DictReader(f))

                  self.assertEqual(new, old)
        </pre>
      </code>
    </div>
    <div class="info"><span class="remind">from index.coci.glob import process</span><br>
      <div class="codebg">
        <code>
          <pre>
            def process(input_dir, output_dir):
    if not exists(output_dir):
        makedirs(output_dir)
          </pre>
        </code>
      </div>
      </div>

      <div class="info"><span class="remind">from os import sep, makedirs</span><br>
        <ol>
          <li> <b>os.sep</b>: The character used by the operating system to separate pathname components. This is '/' for POSIX and '\\' for Windows. Note that knowing this is not sufficient to be able to parse or concatenate pathnames — use os.path.split() and os.path.join() — but it is occasionally useful. Also available via os.path. </li>
          <li> <b>os.makedirs</b>: os.makedirs(name, mode=0o777, exist_ok=False) is a recursive directory creation function. Like mkdir(), but makes all intermediate-level directories needed to contain the leaf directory. </li>
        </ol>
        </div>

        <div class="info"><span class="remind">from os.path import exists</span><br>
          <p> <b>os.path.exists</b>:os.path.exists(path)
return True if path refers to an existing path or an open file descriptor. Returns False for broken symbolic links. On some platforms, this function may return False if permission is not granted to execute os.stat() on the requested file, even if the path physically exists. In more recent versions (Python 3.3 and 3.6) path can be an integer (True is returned if it is an open file descriptor, False otherwise) and paths like objects are now accepted.  </p>
          </div>

          <div class="info"><span class="remind">from shutil import rmtree</span><br>
            <p> <b>shutil.rmtree</b>: shutil.rmtree(path, ignore_errors=False, onerror=None)
delete an entire directory tree; path must point to a directory (but not a symbolic link to a directory). If ignore_errors is true, errors resulting from failed removals will be ignored; if false or omitted, such errors are handled by calling a handler specified by onerror or, if that is omitted, they raise an exception. </p>
            </div>

            <div class="info"><span class="remind">from index.storer.csvmanager import CSVManager</span><br>
              <div class="codebg">
                <code>
                  <pre>
                    class CSVManager(object):
                        """This class is able to load a simple CSV composed by two fields, 'id' and
                        'value', and then to index all its items in a structured form so as to be
                        easily queried. In addition, it allows one to store new information in the CSV,
                        if needed."""

                        def __init__(self, csv_path=None, line_threshold=10000, store_new=True):
                            self.csv_path = csv_path
                            self.data = {}
                            self.store_new = store_new

                            if csv_path is not None and exists(csv_path):
                                CSVManager.__load_all_csv_files([csv_path], self.__load_csv, line_threshold=line_threshold)

                        @staticmethod
                        def load_csv_column_as_set(file_or_dir_path, key, line_threshold=10000):
                            result = set()

                            if exists(file_or_dir_path):
                                file_to_process = []
                                if isdir(file_or_dir_path):
                                    for cur_dir, cur_subdir, cur_files in walk(file_or_dir_path):
                                        for cur_file in cur_files:
                                            if cur_file.endswith(".csv"):
                                                file_to_process.append(cur_dir + sep + cur_file)
                                else:
                                    file_to_process.append(file_or_dir_path)

                                for item in CSVManager.__load_all_csv_files(file_to_process, CSVManager.__load_csv_by_key,
                                                                            line_threshold=line_threshold, key=key):
                                    result.update(item)

                            return result

                        @staticmethod
                        def __load_csv_by_key(csv_string, key):
                            result = set()

                            csv_metadata = DictReader(StringIO(csv_string), delimiter=',')
                            for row in csv_metadata:
                                result.add(row[key])

                            return result

                        @staticmethod
                        def __load_all_csv_files(list_of_csv_files, fun, line_threshold, **params):
                            result = []
                            header = None

                            for csv_path in list_of_csv_files:
                                with open(csv_path, encoding="utf-8") as f:
                                    csv_content = ""
                                    for idx, line in enumerate(f.readlines()):
                                        if header is None:
                                            header = line
                                            csv_content = header
                                        else:
                                            if idx % line_threshold == 0:
                                                result.append(fun(csv_content, **params))
                                                csv_content = header
                                            csv_content += line

                                result.append(fun(csv_content, **params))

                            return result

                        def get_value(self, id_string):
                            """It returns the set of values associated to the input 'id_string',
                            or None if 'id_string' is not included in the CSV."""
                            if id_string in self.data:
                                return set(self.data[id_string])

                        def add_value(self, id_string, value):
                            """It adds the value specified in the set of values associated to 'id_string'.
                            If the object was created with the option of storing also the data in a CSV
                            ('store_new' = True, default behaviour), then it also add new data in the CSV."""
                            if id_string not in self.data:
                                self.data[id_string] = set()

                            if value not in self.data[id_string]:
                                self.data[id_string].add(value)

                                if self.csv_path is not None and self.store_new:
                                    if not exists(self.csv_path):
                                        with open(self.csv_path, "w") as f:
                                            f.write('"id","value"\n')

                                    with open(self.csv_path, "a") as f:
                                        f.write('"%s","%s"\n' % (id_string.replace('"', '""'),
                                                                 value.replace('"', '""')))

                        def __load_csv(self, csv_string):
                            csv_metadata = DictReader(StringIO(csv_string), delimiter=',')
                            for row in csv_metadata:
                                cur_id = row["id"]
                                if cur_id not in self.data:
                                    self.data[cur_id] = set()

                                self.data[cur_id].add(row["value"])
                  </pre>
                </code>
              </div>
              </div>

              <div class="info"><span class="remind">from index.croci.crowdsourcedcitationsource import CrowdsourcedCitationSource</span><br>
                <div class="codebg">
                  <code>
                    <pre>
                      class CrowdsourcedCitationSource(CSVFileCitationSource):
                          def __init__(self, src, local_name=""):
                              self.doi = DOIManager()
                              super(CrowdsourcedCitationSource, self).__init__(src, local_name)

                          def get_next_citation_data(self):
                              row = self._get_next_in_file()

                              while row is not None:
                                  citing = self.doi.normalise(row.get("citing_id"))
                                  cited = self.doi.normalise(row.get("cited_id"))

                                  if citing is not None and cited is not None:
                                      created = row.get("citing_publication_date")
                                      if not created:
                                          created = None

                                      cited_pub_date = row.get("cited_publication_date")
                                      if not cited_pub_date:
                                          timespan = None
                                      else:
                                          c = Citation(None, None, created, None, cited_pub_date, None, None, None, None, "", None, None, None, None, None)
                                          timespan = c.duration

                                      self.update_status_file()
                                      return citing, cited, created, timespan, None, None

                                  self.update_status_file()
                                  row = self._get_next_in_file()

                              remove(self.status_file)
                    </pre>
                  </code>
                </div>
                </div>

                <div class="info"><span class="remind">from csv import DictReader</span><br>
                  <p> <b>class csv.DictReader</b>(f, fieldnames=None, restkey=None, restval=None, dialect='excel', *args, **kwds)
create an object that operates like a regular reader but maps the information in each row to a dict whose keys are given by the optional fieldnames parameter.
The fieldnames parameter is a sequence. If fieldnames is omitted, the values in the first row of file f will be used as the fieldnames. Regardless of how the fieldnames are determined, the dictionary preserves their original ordering.
If a row has more fields than fieldnames, the remaining data is put in a list and stored with the fieldname specified by restkey (which defaults to None). If a non-blank row has fewer fields than fieldnames, the missing values are filled-in with the value of restval (which defaults to None). </p>
<p>Example:</p>
              <div class="codebg">
                    <code>
                      <pre>
                        >>> import csv
                        >>> with open('names.csv', newline='') as csvfile:
                        ...     reader = csv.DictReader(csvfile)
                        ...     for row in reader:
                        ...         print(row['first_name'], row['last_name'])
                        ...
                        Eric Idle
                        John Cleese

                        >>> print(row)
                        {'first_name': 'John', 'last_name': 'Cleese'}
                      </pre>
                    </code>
                  </div>
                  </div>

<p>Sources:<a href="https://docs.python.org/3/library/">The Python Standard Library</a> and <a href="https://github.com/opencitations/index">OpenCitations Index</a> </p>



    <h2>Exercises</h2>
    <h3>Beginners 1</h3>
    <div class="codebg">
      <pre>
        <code>
import unittest

def t(x, y):
    return x + y - 2

class TestT(unittest.TestCase):
    def test_t(self):
        actual = t(x=5, y=6)
        expected = 5+6-2
        self.assertEqual(actual, expected)
        </code>
      </pre>
    </div>
<p>In this way it works</p>
    <div class="codebg">
      <pre>
        <code>
        import unittest

        class TestT(unittest.TestCase):
            def test_t(self):
                result = t(x, y)
                expected = x + y -2
                self.assertEqual(result, expected)

        def t(x, y):
            return x + y - 2
        </code>
      </pre>
    </div>
<p>((In this way it doesn't. I think I know why but I'd like to clarify this point)) </p>
<div class="codebg">
  <code>
    <pre>
      def t(x, y):
          return x + y - 2

      import unittest

      class TestT(unittest.TestCase):
          def test_t(self):
              self.assertEqual(t(5,9), 12)


      if __name__ == "__main__":
          unittest.main()
    </pre>
  </code>
</div>
<p>In this way it works and I also have the result displayed in Pycharm console</p>
<h3>Beginners 2</h3>
<div class="codebg">
  <code>
    <pre>
def f(s1, s2):
    if len(s1) > len(s2):
        return -1
    elif len(s1) < len(s2):
        return 1
    else:
        return 0

import unittest

class TestF(unittest.TestCase):
    def test_f(self):
        self.assertEqual(f("dog","cat"), 0)
        self.assertEqual(f("dog","monkey"), 1)
        self.assertEqual(f("dog", "my"), -1)


if __name__ == "__main__":
    unittest.main()
    </pre>
  </code>
</div>
<h3>Beginners 3</h3>
<div class="codebg">
  <code>
    <pre>
      def f(s1, s2):
          result = set()

          for c in s1:
              if c in s2:
                  result.add(c)

          return result

      import unittest

      class TestF(unittest.TestCase):
          def test_f(self):
              self.assertEqual(f("123","435"), {"3"})
              self.assertEqual(f("126","435"), set()) #if I use {} it doesn't work
              self.assertEqual(f("brother","sister"), {"r","t","e"})
              self.assertEqual(f("cat","catsitter"), {"c","a","t"})

      if __name__ == "__main__":
          unittest.main()
    </pre>
  </code>
</div>
<p>Original codes source: <a href="https://comp-think.github.io/">The CTP Book</a> </p>

    <h2>Issues</h2>
    <ol>
      <li># check that s.split fails when the separator is not a string \\
      with self.assertRaises(TypeError):\\
          s.split(2)\\?</li>
      <li>Why is unittest more efficient then other testing approaches?</li>
      <li>In practice, when and how do we use assertRaises(TypeError)? </li>
      <li>if __name__ == '__main__':\\
          unittest.main()</li>
      <li>In many of the tutorials I followed the code is launched through the command prompt. Is it necessary or suggested? Can I work with Pycharm only?</li>
      <li>Is TestSuit necessary in our case? "In most cases, calling unittest.main() will do the right thing and collect all the module’s test cases for you and execute them."</li>
      <li>Does the assertEqual have more or less the same function of the print part of the test case that we used in CTP course? (since -in order to make the test work- some values have to be assigned to the arguments of the tested function) </li>
      <li>For now I'm only using assertEqual() since I have some troubles in understanding how all the other methods could be applied in tests (how can I do something more than testing if the result of the function matches the expected one? In OpenCitation which other ones are mainly used?).</li>
      <li>SetUp(): real contexts of use (examples)? In particular setUp in CrociTest <br> self.input_file = "index%stest_data%scroci_dump%ssource.csv" % (sep, sep, sep) <br>
        self.citations = "index%stest_data%scroci_dump%scitations.csv" % (sep, sep, sep)</li>
    </ol>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Week #2 (01-21-21)
        </button>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">
          <h2>NIH library data</h2>
          <h3>Ten examples</h3>
          <p>I randomly extracted ten samples from the open_citation_collection.csv and I stored the data in a new csv file (open_citation_collection_sample.csv, then renamed source.csv).</p>
          <div class="codebg"><code><pre>C:\Users\arimoretti\Desktop\TESI\icite>pip install subsample
Collecting subsample
  Downloading https://files.pythonhosted.org/packages/21/86/ff247222b81baa8b47a9970c76e6f930662d7b9336e669f7e4b39857e674/subsample-0.0.6.tar.gz
Installing collected packages: subsample
  Running setup.py install for subsample ... done
Successfully installed subsample-0.0.6
WARNING: You are using pip version 19.2.3, however version 21.0.1 is available.
You should consider upgrading via the 'python -m pip install --upgrade pip' command.

C:\Users\arimoretti\Desktop\TESI\icite>subsample -n 10 open_citation_collection.csv > open_citation_collection_sample.csv
LOG 03:21 > Data begins at 0

C:\Users\arimoretti\Desktop\TESI\icite></pre></code></div>
          <ol>
              <li>2140506,2942070</li>
              <li>1523579,7097569</li>
              <li>1509982,6501574</li>
              <li>1968312,13673087</li>
              <li>2330868,3958380</li>
              <li>1854174,3037997</li>
              <li>2038824,2494239</li>
              <li>2373284,7189714</li>
              <li>3591292,4092853</li>
              <li>2368927,355650</li>
          </ol>
          <h3>Notes on format</h3>
          <p>Before extracting data, we expected these to be either PMCID or  PMID. The pure numeric format denotes that we are handling PMIDs.</p>
          <p>OC process is based on the use of a <strong>tuple of six values</strong> derived from the citation source(citing, cited, created, timespan, journal_sc, author_sc). However, here we just have two of these values, which are also the only indispensable ones (i.e. citing + referenced/cited).</p>
          
          <h2>Data mapping</h2>
          <p>The 2 primary identifiers are not DOIs, but PubMedID. Since until now only DOIs have been managed by our process, some of these citations may already be present in Open Citations (COCI: doi to doi only). </p>
          <p>In NIH dataset some articles probably have a doi, but exposed differently. So our options for the mapping are: </p>
          <ol>
              <li>use article additional data provided by icite</li>
              <li>use external mapping datasets</li>
          </ol>
          <h3>External mapping tools</h3>
          <h4>Results obtained with <a href="https://www.pmid2cite.com/pmid-to-doi-converter">www.pmid2cite.com</a></h4>
          <table style="width: 117px;">
<tbody>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">&nbsp;</td>
<td style="height: 22px; width: 64.8px;">PMID citing</td>
<td style="height: 22px; width: 36px;">&nbsp;DOI citing</td>
<td style="height: 22px; width: 36px;">PMID referenced</td>
<td style="height: 22px; width: 36px;">DOI referenced</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">1</td>
<td style="height: 22px; width: 64.8px;">&nbsp;2140506</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1111/j.1445-5994.1990.tb01289.x" target="_blank">10.1111/j.1445-5994.1990.tb01289.x</a></td>
<td style="height: 22px; width: 36px;">2942070</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.7326/0003-4819-105-2-173" target="_blank">10.7326/0003-4819-105-2-173</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">2</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1523579</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1002/tera.1420460305" target="_blank">10.1002/tera.1420460305</a></td>
<td style="height: 22px; width: 36px;">7097569</td>
<td style="height: 22px; width: 36px;">Unable to resolve the DOI&nbsp;</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">3</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1509982</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1007/BF01990957" target="_blank">10.1007/BF01990957</a></td>
<td style="height: 22px; width: 36px;">6501574</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1172/JCI111604" target="_blank">10.1172/JCI111604</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">4</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1968312</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1016/0002-9149(90)90817-k" target="_blank">10.1016/0002-9149(90)90817-k</a></td>
<td style="height: 22px; width: 36px;">13673087</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1172/JCI103906" target="_blank">10.1172/JCI103906</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">5</td>
<td style="height: 22px; width: 64.8px;">&nbsp;2330868</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1016/s0002-8703(05)80240-6" target="_blank">10.1016/s0002-8703(05)80240-6</a></td>
<td style="height: 22px; width: 36px;">3958380</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1016/s0735-1097(86)80214-5" target="_blank">10.1016/s0735-1097(86)80214-5</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">6</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1854174</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1128/aac.35.5.929" target="_blank">10.1128/aac.35.5.929</a></td>
<td style="height: 22px; width: 36px;">3037997</td>
<td style="height: 22px; width: 36px;">
<div id="buttonHide" class="out">
<p class="output"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1128/aac.31.4.497" target="_blank">10.1128/aac.31.4.497</a></p>
</div>
</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">7</td>
<td style="height: 22px; width: 64.8px;">&nbsp;2038824</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1016/0165-2427(91)90031-7" target="_blank">10.1016/0165-2427(91)90031-7</a></td>
<td style="height: 22px; width: 36px;">2494239</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.3168/jds.S0022-0302(89)79089-5" target="_blank">10.3168/jds.S0022-0302(89)79089-5</a></td>
</tr>
<tr style="height: 22.6px;">
<td style="height: 22.6px; width: 15.2px;">8</td>
<td style="height: 22.6px; width: 64.8px;">&nbsp;2373284</td>
<td style="height: 22.6px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1111/j.1432-0436.1990.tb00437.x" target="_blank">10.1111/j.1432-0436.1990.tb00437.x</a></td>
<td style="height: 22.6px; width: 36px;">7189714</td>
<td style="height: 22.6px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1016/0014-4827(80)90437-1" target="_blank">10.1016/0014-4827(80)90437-1</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">9</td>
<td style="height: 22px; width: 64.8px;">&nbsp;3591292</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1111/j.1651-2227.1987.tb10456.x" target="_blank">10.1111/j.1651-2227.1987.tb10456.x</a></td>
<td style="height: 22px; width: 36px;">4092853</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1111/j.1469-8749.1985.tb03805.x" target="_blank">10.1111/j.1469-8749.1985.tb03805.x</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">10</td>
<td style="height: 22px; width: 64.8px;">2368927</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1002/ar.1092270109" target="_blank">10.1002/ar.1092270109</a></td>
<td style="height: 22px; width: 36px;">355650</td>
<td style="height: 22px; width: 36px;">Unable to resolve the DOI&nbsp;</td>
</tr>
</tbody>
</table>

<h4>Results obtained with <a href="https://www.ncbi.nlm.nih.gov/pmc/pmctopmid/#api">/www.ncbi.nlm.nih.gov</a></h4>
          
          <table style="width: 117px;">
<tbody>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">&nbsp;</td>
<td style="height: 22px; width: 64.8px;">PMID citing</td>
<td style="height: 22px; width: 36px;">&nbsp;DOI citing</td>
<td style="height: 22px; width: 36px;">PMID referenced</td>
<td style="height: 22px; width: 36px;">DOI referenced</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">1</td>
<td style="height: 22px; width: 64.8px;">&nbsp;2140506</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">2942070</td>
<td style="height: 22px; width: 36px;">""</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">2</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1523579</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">7097569</td>
<td style="height: 22px; width: 36px;">""</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">3</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1509982</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">6501574</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1172/JCI111604" target="_blank">10.1172/JCI111604</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">4</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1968312</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">13673087</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1172/JCI103906" target="_blank">10.1172/JCI103906</a></td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">5</td>
<td style="height: 22px; width: 64.8px;">&nbsp;2330868</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">3958380</td>
<td style="height: 22px; width: 36px;">""</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">6</td>
<td style="height: 22px; width: 64.8px;">&nbsp;1854174</td>
<td style="height: 22px; width: 36px;"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1128/aac.35.5.929" target="_blank">10.1128/aac.35.5.929</a></td>
<td style="height: 22px; width: 36px;">3037997</td>
<td style="height: 22px; width: 36px;">
<div id="buttonHide" class="out">
<p class="output"><a title="Link by DOI for the given PMID" href="https://doi.org/10.1128/aac.31.4.497" target="_blank">10.1128/aac.31.4.497</a></p>
</div>
</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">7</td>
<td style="height: 22px; width: 64.8px;">&nbsp;2038824</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">2494239</td>
<td style="height: 22px; width: 36px;">""</td>
</tr>
<tr style="height: 22.6px;">
<td style="height: 22.6px; width: 15.2px;">8</td>
<td style="height: 22.6px; width: 64.8px;">&nbsp;2373284</td>
<td style="height: 22.6px; width: 36px;">""</td>
<td style="height: 22.6px; width: 36px;">7189714</td>
<td style="height: 22.6px; width: 36px;">""</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">9</td>
<td style="height: 22px; width: 64.8px;">&nbsp;3591292</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">4092853</td>
<td style="height: 22px; width: 36px;">""</td>
</tr>
<tr style="height: 22px;">
<td style="height: 22px; width: 15.2px;">10</td>
<td style="height: 22px; width: 64.8px;">2368927</td>
<td style="height: 22px; width: 36px;">""</td>
<td style="height: 22px; width: 36px;">355650</td>
<td style="height: 22px; width: 36px;">""</td>
</tr>
</tbody>
</tbody>
</table>
        
<p>As we can see, results obtained by using different tools are not the same. It is evident that the first tool obtains better results, but - most importantly - neither the one nor the other is able to match 100% of PMID-DOI couples. So, the mapping is incomplete.</p>
          
          <h2>Notes on expected structure of the main function</h2> 
        <p>In order to understand what kind of input and output to expect, we can start from the model provided by CROCI.</p>
          <h2>Test Case development</h2>
        <p>Reference Test Case:</p>
        <h3>index/test/09_croci.py</h3>
        <div class="codebg"><code><pre>          import unittest
          from index.coci.glob import process
          from os import sep, makedirs
          from os.path import exists
          from shutil import rmtree
          from index.storer.csvmanager import CSVManager
          from index.croci.crowdsourcedcitationsource import CrowdsourcedCitationSource
          from csv import DictReader


          class CROCITest(unittest.TestCase):

              def setUp(self):
                  self.input_file = "index%stest_data%scroci_dump%ssource.csv" % (sep, sep, sep)
                  self.citations = "index%stest_data%scroci_dump%scitations.csv" % (sep, sep, sep)

              def test_citation_source(self):
                  ccs = CrowdsourcedCitationSource(self.input_file)
                  new = []
                  cit = ccs.get_next_citation_data()
                  while cit is not None:
                      citing, cited, creation, timespan, journal_sc, author_sc = cit
                      new.append({
                          "citing": citing,
                          "cited": cited,
                          "creation": "" if creation is None else creation,
                          "timespan": "" if timespan is None else timespan,
                          "journal_sc": "no" if journal_sc is None else journal_sc,
                          "author_sc": "no" if author_sc is None else author_sc
                      })
                      cit = ccs.get_next_citation_data()

                  with open(self.citations) as f:
                      old = list(DictReader(f))

                  self.assertEqual(new, old)</pre></code></div>
        
        <h3>On this base, a basic idea of index/test/(n?)_noci.py</h3>
        
        <iframe src="https://trinket.io/embed/python/221e5803ec?toggleCode=true" width="100%" height="356" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>
        
        
        <div class="codebg">
            <code>
                <pre>
        
import unittest
from index.coci.glob import process #something to be developed to perform the same task but with pmids
from os import sep, makedirs  #Recursive directory creation function. Like mkdir(), but makes all intermediate-level directories needed to contain the leaf directory.
from os.path import exists  #used to check whether the specified path exists or not.
from shutil import rmtree #used to delete an entire directory tree, path must point to a directory (but not a symbolic link to a directory)
from index.storer.csvmanager import CSVManager #This class is able to load a simple CSV composed by two fields, 'id' and'value', and then to index all its items in a structured form so as to be easily queried. In addition, it allows one to store new information in the CSV, if needed.
from index.noci.nationalinstituteofhealthsource import NationalInstitutHealthSource #crowdsourcedcitationsource sostituito
from csv import DictReader


class NOCITest(unittest.TestCase):

    def setUp(self): #The self parameter is a reference to the current instance of the class, and is used to access variables that belongs to the class.
        self.input_file = "index%stest_data%snoci_dump%ssource.csv" % (sep, sep, sep) #without placeholders for the tuple format, data as provided by NIH
        self.citations = "index%stest_data%snoci_dump%scitations.csv" % (sep, sep, sep) #adaptation for tuple format, with all 6 fields
    def test_citation_source(self):
        ns = NationalInstitutHealthSource(self.input_file) #class of nationalinstituteofhealthsource, where a version of get next citation handling pmid data will be defined.
        new = []
        cit = ns.get_next_citation_data_pmidversion() #will extract citational data from our input file, which is the source one, with just citing and cited
        while cit is not None: #(which is: until we have citational data)
            citing, cited, creation, timespan, journal_sc, author_sc = cit #related to the csv format (?) does the comma separator define the fields, so that cit becomes che full ciation divided by fields?
            #we append each citational data to the new list (which will be a list of dictionaries), in the format required for the 6-elements tuple.
            new.append({
                "citing": citing,
                "cited": cited,
                "creation": "" if creation is None else creation, #in all our cases the last four fields will be "","","no","no"
                "timespan": "" if timespan is None else timespan,
                "journal_sc": "no" if journal_sc is None else journal_sc,
                "author_sc": "no" if author_sc is None else author_sc
            })
            cit = ns.get_next_citation_data_pmidversion() #cit variable is assigned the value of the subsequent citational datum from input_file (source.csv)

        with open(self.citations) as f: #open the file as a parameter of a function, this time the csv with the data compiled in the 6-elements tuple format
            old = list(DictReader(f)) #a list of dictionaries is derived from data in citations.


        self.assertEqual(new, old) #check that the lists of dictionaries derived respectively from source and from citations are the equal.
                </pre>
            </code>
        </div>
          <h2>Prompt: basic commands</h2>
        <h3>General</h3>
        <ul>
            <li>Lists Installed Drivers (<strong>driverquery</strong>): get a full list of installed drivers in your pc (driverquery -v to obtain more information). </li>
            <li><strong>ipconfig</strong>: provides your ip address + your local network.</li>
            <li><strong>systeminfo</strong>:  to know very basic information about your pc’s hardware, like – motherboard, processor, ram</li>
            <li><strong>ping</strong>:sends packets of data to a specific IP address (or domain) on a network and then lets you know how long it took to transmit that data and get a response (ping + ip or domain).</li>
            <li><strong>sfc /scannow</strong>scan and repare windown system files. But you must be run the console as an administrator</li>
            <li><strong>tasklist</strong>: gets a list of all tasks running on your pc (tasklist -v). </li>
            <li><strong>cd</strong>: </li>
            <ol>
                <li><strong>cd\</strong> to go to the top of the directory tree</li>
                <li><strong>CD Folder</strong>to go to a specific folder from this drive. The subfolders must be separated by a backslash character: \.</li>
                <li><strong>cd..</strong>to go one folder up.</li>
            </ol>
            <li>To change the drive from “C:” to “D:”, type d:</li>
            <li><strong>mkdir</strong>:  (Make Directory) command. mkdir Folder creates a folder.</li>
            <li><strong>cls</strong>: clear screen, to clear the command prompt screen.</li>
        </ul>
        <p>Source: <a href="https://dev.to/iamprogrammmer/command-prompt-basic-commands-you-should-know-cmd-4aj">dev.to</a></p>
        <h3>Unittest</h3>
        <p> Unittest from command line in order to make tests on modules, classes or specific methods</p>
        <ul>
            <li>python -m unittest test_module1 test_module2</li>
            <li>python -m unittest test_module.TestClass</li>
            <li>python -m unittest test_module.TestClass.test_method</li>
        </ul>
        <p>Test modules can be specified by file path, e.g.: python -m unittest tests/test_something.py</p>
        <p>For additional information, we can obtain tests with more detail (higher verbosity) by passing in the -v flag: python -m unittest -v test_module</p>
        <p>List of all command line options: python -m unittest -h</p>
        <div class="codebg">
            <code>
                <pre>
                C:\Users\arimoretti>python -m unittest -h
usage: python.exe -m unittest [-h] [-v] [-q] [--locals] [-f] [-c] [-b] [-k TESTNAMEPATTERNS] [tests [tests ...]]

positional arguments:
  tests                a list of any number of test modules, classes and test methods.

optional arguments:
  -h, --help           show this help message and exit
  -v, --verbose        Verbose output
  -q, --quiet          Quiet output
  --locals             Show local variables in tracebacks
  -f, --failfast       Stop on first fail or error
  -c, --catch          Catch Ctrl-C and display results so far
  -b, --buffer         Buffer stdout and stderr during tests
  -k TESTNAMEPATTERNS  Only run tests which match the given substring

Examples:
  python.exe -m unittest test_module               - run tests from test_module
  python.exe -m unittest module.TestClass          - run tests from module.TestClass
  python.exe -m unittest module.Class.test_method  - run specified test method
  python.exe -m unittest path/to/test_file.py      - run tests from test_file.py

usage: python.exe -m unittest discover [-h] [-v] [-q] [--locals] [-f] [-c] [-b] [-k TESTNAMEPATTERNS] [-s START]
                                       [-p PATTERN] [-t TOP]

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         Verbose output
  -q, --quiet           Quiet output
  --locals              Show local variables in tracebacks
  -f, --failfast        Stop on first fail or error
  -c, --catch           Catch Ctrl-C and display results so far
  -b, --buffer          Buffer stdout and stderr during tests
  -k TESTNAMEPATTERNS   Only run tests which match the given substring
  -s START, --start-directory START
                        Directory to start discovery ('.' default)
  -p PATTERN, --pattern PATTERN
                        Pattern to match tests ('test*.py' default)
  -t TOP, --top-level-directory TOP
                        Top level directory of project (defaults to start directory)

For test discovery (python -m unittest) all test modules must be importable from the top level directory of the project.

C:\Users\arimoretti>
                </pre>
            </code>

        </div>
<p>Source: <a href="https://docs.python.org/3/library/unittest.html">docs.python.org</a></p>

          <h2>Clone locally OC index so to run tests.</h2>
        <p> I tried to clone OC index locally but something went wrong.</p>
        <div class="codebg"><code><pre>
        Cloning into 'C:\Users\arimoretti\Documents\GitHub\index'...
remote: Enumerating objects: 1040, done.        
remote: Counting objects: 100% (1040/1040), done.        
remote: Compressing objects: 100% (481/481), done.        
remote: Total 1040 (delta 373), reused 913 (delta 254), pack-reused 0        
Receiving objects: 100% (1040/1040), 172.79 KiB | 875.00 KiB/s, done.
Resolving deltas: 100% (373/373), done.
error: invalid path 'test_data/tmp_load/data/csv/2020/05/2020-05-18T11:01:36_1.csv'
fatal: unable to checkout working tree
warning: Clone succeeded, but checkout failed.
You can inspect what was checked out with 'git status'
and retry with 'git restore --source=HEAD :/'
        </pre></code></div>
        <p>Then I tried to fix it on my own but I didn't succeed.</p>
        <div class="codebg"><code><pre>
        
C:\Users\arimoretti\Documents\GitHub\index> git status
On branch master
Your branch is up to date with 'origin/master'.

Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
        deleted:    .gitignore
        deleted:    README.md
        deleted:    __init__.py
        deleted:    citation/__init__.py
        deleted:    citation/citationsource.py
        deleted:    citation/oci.py
        deleted:    cnc.py
        deleted:    coci/checkmetadata.py
        deleted:    coci/crossrefcitationsource.py
        deleted:    coci/glob.py
        deleted:    coci/trimdump.py
        deleted:    croci/crowdsourcedcitationsource.py
        deleted:    finder/__init__.py
        deleted:    finder/crossrefresourcefinder.py
        deleted:    finder/dataciteresourcefinder.py
        deleted:    finder/orcidresourcefinder.py
        deleted:    finder/resourcefinder.py
        deleted:    identifier/doimanager.py
        deleted:    identifier/identifiermanager.py
        deleted:    identifier/issnmanager.py
        deleted:    identifier/orcidmanager.py
        deleted:    storer/__init__.py
        deleted:    storer/citationstorer.py
        deleted:    storer/csvmanager.py
        deleted:    storer/updatetp.py
        deleted:    support/__init__.py
        deleted:    support/csv.py
        deleted:    support/dictionary.py
        deleted:    support/stats.py
        deleted:    test/01_csvmanager.py
        deleted:    test/02_identifiermanager.py
        deleted:    test/03_resourcefinder.py
        deleted:    test/04_oci.py
        deleted:    test/05_citationstorer.py
        deleted:    test/06_citationsource.py
        deleted:    test/07_cnc.py
        deleted:    test/08_coci.py
        deleted:    test/09_croci.py
        deleted:    test/__init__.py
        deleted:    test/test.py
        deleted:    test_data/additional_data.csv
        deleted:    test_data/citations_data.csv
        deleted:    test_data/citations_data.ttl
        deleted:    test_data/citations_data_prov.scholix
        deleted:    test_data/citations_partial.csv
        deleted:    test_data/citations_prov.csv
        deleted:    test_data/citations_prov.ttl
        deleted:    test_data/cnc_id_date.csv
        deleted:    test_data/cnc_id_issn.csv
        deleted:    test_data/cnc_id_orcid.csv
        deleted:    test_data/cnc_valid_doi.csv
        deleted:    test_data/croci_dump/citations.csv
        deleted:    test_data/croci_dump/source.csv
        deleted:    test_data/crossref_dump/1.json
        deleted:    test_data/crossref_dump/2.json
        deleted:    test_data/crossref_dump/citations.csv
        deleted:    test_data/crossref_dump/id_date.csv
        deleted:    test_data/crossref_dump/id_issn.csv
        deleted:    test_data/crossref_dump/id_orcid.csv
        deleted:    test_data/crossref_dump/valid_doi.csv
        deleted:    test_data/crossref_glob/id_date.csv
        deleted:    test_data/crossref_glob/id_issn.csv
        deleted:    test_data/crossref_glob/id_orcid.csv
        deleted:    test_data/crossref_glob/valid_doi.csv
        deleted:    test_data/id_date.csv
        deleted:    test_data/id_issn.csv
        deleted:    test_data/id_orcid.csv
        deleted:    test_data/initial_data.csv
        deleted:    test_data/lookup_full.csv
        deleted:    test_data/lookup_new.csv
        deleted:    test_data/tmp_load/data/csv/2020/05/2020-05-18T11:01:36_1.csv
        deleted:    test_data/tmp_load/data/rdf/2020/05/2020-05-18T11:01:36_1.ttl
        deleted:    test_data/tmp_load/data/slx/2020/05/2020-05-18T11:01:36_1.scholix
        deleted:    test_data/tmp_load/prov/csv/2020/05/2020-05-18T11:01:36_1.csv
        deleted:    test_data/tmp_load/prov/rdf/2020/05/2020-05-18T11:01:36_1.ttl
        deleted:    test_data/tmp_store/data/csv/2020/05/2020-05-18T11:01:36_1.csv
        deleted:    test_data/tmp_store/data/csv/2020/05/2020-05-18T11:01:36_2.csv
        deleted:    test_data/tmp_store/data/csv/2020/05/2020-05-18T11:01:36_3.csv
        deleted:    test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_1.ttl
        deleted:    test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_2.ttl
        deleted:    test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_3.ttl
        deleted:    test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_4.ttl
        deleted:    test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_5.ttl
        deleted:    test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_6.ttl
        deleted:    test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_1.scholix
        deleted:    test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_2.scholix
        deleted:    test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_3.scholix
        deleted:    test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_4.scholix
        deleted:    test_data/tmp_store/prov/csv/2020/05/2020-05-18T11:01:36_1.csv
        deleted:    test_data/tmp_store/prov/csv/2020/05/2020-05-18T11:01:36_2.csv
        deleted:    test_data/tmp_store/prov/csv/2020/05/2020-05-18T11:01:36_3.csv
        deleted:    test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_1.ttl
        deleted:    test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_2.ttl
        deleted:    test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_3.ttl
        deleted:    test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_4.ttl
        deleted:    test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_5.ttl
        deleted:    test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_6.ttl
        deleted:    test_data/tmp_workflow/data/csv/2020/05/2020-05-18T11:01:49_1.csv
        deleted:    test_data/tmp_workflow/data/rdf/2020/05/2020-05-18T11:01:49_1.ttl
        deleted:    test_data/tmp_workflow/data/slx/2020/05/2020-05-18T11:01:49_1.scholix
        deleted:    test_data/tmp_workflow/prov/csv/2020/05/2020-05-18T11:01:49_1.csv
        deleted:    test_data/tmp_workflow/prov/rdf/2020/05/2020-05-18T11:01:49_1.ttl
        deleted:    test_data/valid_doi.csv


C:\Users\arimoretti\Documents\GitHub\index>git restore --staged test_data/tmp_load/data/csv/2020/05/2020-05-18T11:01:36_1.csv
error: invalid path 'test_data/tmp_load/data/csv/2020/05/2020-05-18T11:01:36_1.csv'
error: pathspec 'test_data/tmp_load/data/csv/2020/05/2020-05-18T11:01:36_1.csv' did not match any file(s) known to git

C:\Users\arimoretti\Documents\GitHub\index>git restore --source=HEAD :/
error: invalid path 'test_data/tmp_load/data/csv/2020/05/2020-05-18T11:01:36_1.csv'
error: invalid path 'test_data/tmp_load/data/rdf/2020/05/2020-05-18T11:01:36_1.ttl'
error: invalid path 'test_data/tmp_load/data/slx/2020/05/2020-05-18T11:01:36_1.scholix'
error: invalid path 'test_data/tmp_load/prov/csv/2020/05/2020-05-18T11:01:36_1.csv'
error: invalid path 'test_data/tmp_load/prov/rdf/2020/05/2020-05-18T11:01:36_1.ttl'
error: invalid path 'test_data/tmp_store/data/csv/2020/05/2020-05-18T11:01:36_1.csv'
error: invalid path 'test_data/tmp_store/data/csv/2020/05/2020-05-18T11:01:36_2.csv'
error: invalid path 'test_data/tmp_store/data/csv/2020/05/2020-05-18T11:01:36_3.csv'
error: invalid path 'test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_1.ttl'
error: invalid path 'test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_2.ttl'
error: invalid path 'test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_3.ttl'
error: invalid path 'test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_4.ttl'
error: invalid path 'test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_5.ttl'
error: invalid path 'test_data/tmp_store/data/rdf/2020/05/2020-05-18T11:01:36_6.ttl'
error: invalid path 'test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_1.scholix'
error: invalid path 'test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_2.scholix'
error: invalid path 'test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_3.scholix'
error: invalid path 'test_data/tmp_store/data/slx/2020/05/2020-05-18T11:01:36_4.scholix'
error: invalid path 'test_data/tmp_store/prov/csv/2020/05/2020-05-18T11:01:36_1.csv'
error: invalid path 'test_data/tmp_store/prov/csv/2020/05/2020-05-18T11:01:36_2.csv'
error: invalid path 'test_data/tmp_store/prov/csv/2020/05/2020-05-18T11:01:36_3.csv'
error: invalid path 'test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_1.ttl'
error: invalid path 'test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_2.ttl'
error: invalid path 'test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_3.ttl'
error: invalid path 'test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_4.ttl'
error: invalid path 'test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_5.ttl'
error: invalid path 'test_data/tmp_store/prov/rdf/2020/05/2020-05-18T11:01:36_6.ttl'
error: invalid path 'test_data/tmp_workflow/data/csv/2020/05/2020-05-18T11:01:49_1.csv'
error: invalid path 'test_data/tmp_workflow/data/rdf/2020/05/2020-05-18T11:01:49_1.ttl'
error: invalid path 'test_data/tmp_workflow/data/slx/2020/05/2020-05-18T11:01:49_1.scholix'
error: invalid path 'test_data/tmp_workflow/prov/csv/2020/05/2020-05-18T11:01:49_1.csv'
error: invalid path 'test_data/tmp_workflow/prov/rdf/2020/05/2020-05-18T11:01:49_1.ttl'

C:\Users\arimoretti\Documents\GitHub\index>git restore --source=HEAD :/

        </pre></code></div>
            <h3>Structure</h3>
            <p>However, I created some folders on my pc, so to integrate them later, when I'll be able to clone the whole repository locally (an index folder containing 3 folders: noci (with nationalinstituteofhealthsource.py), test (with 10_noci.py) and test_data (with noci_dump, containing citations.csv and source.csv))</p>

            
          <h2>Self Citation</h2>
          <p> In COCI, 29,755,045 (6.7%) citations are journal self-citations, while 250,991 (0.06%)are author self-citations. In fact, the two cases in which we define a self-citation are:</p>
          <ul>
              <li>Citing and Cited articles belong to the same journal</li>
              <li>There is at least one author in common between the group of citing authors and the group of cited authors</li>
          </ul>
              
        <p>However, the second case is more difficult to handle, because of the problem of the sparsity of data about ORCID author identifers in Crossref database. </p>
          <p>Source: <a href="Heibi2019_Article_SoftwareReviewCOCITheOpenCitat.pdf">Software review: COCI, the OpenCitations Index of Crossref open DOI‑to‑DOI citations</a></p>
          <h2>Issues</h2>
          <ol>
              <li>From my notes in "Meetings": The <strong>DOI</strong> may be (and probably is) present; however, we can't rely on this + In this dataset we will probably have the <strong>"selfcitation" info</strong>. --> Since in the open_citation_collection.csv we only have citing and referenced, are those data supposed to be in icite_metadata.zip?</li>
              <li>I tried to use a couple of mapping tools, one of which should be the one we discussed in the last meeting (they basically perform the same task, however).</li>
              <ul>
                  <li>For some PMID,e.g. 4151790, I was able to find the correspondent DOI, i.e. 10.1083/jcb.61.3.688, both with <a href="https://www.pmid2cite.com/pmid-to-doi-converter">www.pmid2cite.com/pmid-to-doi-converter</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/pmctopmid/#api">www.ncbi.nlm.nih.gov/pmc/pmctopmid</a> coverter, (with this latter allowing the download of a generated file in the specified format -in my case I selected CSV*). However, I was not able to use the API service (it's the very first time I've tried to use an API service, so I really don't know where did I go wrong). I typed "service-root?ids=4145504" as required, and got back an error message. Maybe It's not necesary for me in this phase to learn how to use this tool, but I would like to understand why I can't make it work.</li>
                  <li>Is it possible/normal that pmid2cite tools performs better than NIH official tool? If so, why?</li>
              </ul>
              <li>I still don't get fully the % separator issue. I tried reading the os documentation and analysing OC correspondent files and I still don't understand (a) why we use % specifying it as separator (instead of the simple slash) and (b)why we add an "s" after it in the path name. I know I asked a similar question last time, but I was pretty sure I understood, while I'm realizing I didn't. </li>
              <li>I have some doubts concerning the general settings of the test function I should develop: It's like it stays really similar to the croci one, and that the only parts that have to be changed are called functions that are external to the test case itself. But maybe the point was just focusing on them, in order to uderstand which parts of the overall process I won't be able to reuse, since they were implementes for DOIs only. In this latter case, I'm not so far from understanding. Otherwise I'll try to study the function better and properly prepare it for next time.</li>
              <li>I didn't succeed in locally cloning the oc index from github.</li>
              <li> In the csv files I created i changed "referenced" with "cited" for uniformity purposes. Is it correct or should I keep the original label by NIH?</li>
              <li> I have some doubts about this line of code in 09_croci.py : citing, cited, creation, timespan, journal_sc, author_sc = cit . Is it like defining the labels of the columns in the csv file? i.e. : is it related to the csv format, so that the comma separator define the fields, and cit becomes che full ciation divided by fields?</li>
              <li>I don't get properly the value of the variable c in this part of the function of the class CrowdsourcedCitationSource in crowdsourcedcitationsource.py:</li>
              <div class="codebg">
                  <code>
                      <pre>
                      cited_pub_date = row.get("cited_publication_date")
                if not cited_pub_date:
                    timespan = None
                else:
                    c = Citation(None, None, created, None, cited_pub_date, None, None, None, None, "", None, None, None, None, None)
                    timespan = c.duration
                      </pre>
                  </code>
              </div>
          </ol>
          <p>*</p>
          <div class="codebg">          <code><pre>"PMID","PMCID","DOI","Version","MID","IsCurrent","IsLive","ReleaseDate","Msg"
"4151790","PMC2109316","10.1083/jcb.61.3.688","","","",1,"",""</pre></code></div>

      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          Week #3 (02-5-21)
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">
          <h2>Download Metadata File</h2>
          <p>sample</p>
          <div class="codebg">
              <code>
                  <pre>
                  "pmid","doi","title","authors","year","journal","is_research_article","citation_count","field_citation_rate","expected_citations_per_year","citations_per_year","relative_citation_ratio","nih_percentile","human","animal","molecular_cellular","x_coord","y_coord","apt","is_clinical","cited_by_clin","cited_by","references","provisional"
20961202,"10.1515/CCLM.2010.324","Thyroid hormones are stable even during prolonged frozen storage.","Tuija Männistö, Eila Suvanto, Heljä-Marja Surcel, Aimo Ruokonen",2010,"Clin. Chem. Lab. Med.",FALSE,7,4.22240468196911,2.40345243945313,0.7,0.29,15.3,0.75,0,0.25,-0.21650635094611,0.625,0.75,FALSE,"","32632723 30734656 31876038 26033776 22323002 27599301 30616423","17954505 20014958","No"
28140346,"10.1088/1758-5090/aa5c1c","Increased lipid accumulation and adipogenic gene expression of adipocytes in 3D bioprinted nanocellulose scaffolds.","I Henriksson, P Gatenholm, D A Hägg",2017,"Biofabrication",TRUE,17,4.05346355438924,2.23977268910794,5.66666666666667,2.53,81.8,0,0.25,0.75,-0.433012701892219,-0.5,0.05,FALSE,"","31992046 32045053 30844234 32159140 31108877 32259809 31273962 30699947 30940007 32365578 30471044 31719887 30741518 31715587 28829453 30271688 31949436","19416711 9442874 17286602 26492473 19402786 20153520 22275210 19398967 26478282 2559938 26017717 24887553 25617132 10875926 15009947 25806996 20170951 24188635 21902468 25411113 22029845 26202781 18038435 18767968 24038000 15084517 26056727 16997371 24912145 17544502 15766899 25384685 23242478 24094166 24866945 23017116 21358040 24464765 26210285 21247363 24192056 25093879 12867492 24819827 26797605 23517589","No"
20961211,"10.3109/10520295.2010.494474","Sensitivity and specificity of cytodiagnosis of body fluids in a laboratory of urgencies.","A E Rocher, F Guerra, J Rofrano, A Angeleri, O E Canessa, G R Mendeluk, L A Palaoro",2011,"Biotech Histochem",TRUE,2,3.22327656896745,1.94254995780862,0.222222222222222,0.11,5.7,1,0,0,0,1,0.05,FALSE,"","27069641 27785319","7819512 7942600 1511123 11349500 19191294 11284303 12589641 10352907 16079317 8693893 17250601 15690338 9237183 8960030 16786726 2430142 1294046 8038428","No"
20961185,"10.1515/CCLM.2011.005","Determination of daptomycin in human plasma by liquid chromatography-tandem mass spectrometry. Clinical application.","Marie-Clémence Verdier, Danièle Bentué-Ferrer, Olivier Tribut, Nicolas Collet, Matthieu Revest, Eric Bellissant",2011,"Clin. Chem. Lab. Med.",TRUE,20,2.97732333867758,1.8402221288327,2.22222222222222,1.21,57.5,0.67,0,0.33,-0.288675134594813,0.5,0.75,FALSE,"28399872 30086083","30295740 28207237 27960546 23545525 21596511 23569376 28399872 31061317 24798278 25979773 32378527 24036034 26020161 30086083 26937555 26512995 23384531 24148450 24037956 26184288","17005801 16455920 1324637 18408238 15762934 12654665 19898996 18838314 9484768 19715980 14972382 17124423 15273084 9061492 17940348 17629567 15705644 17965030 11751107 17284073 1318678 19939597 16455939 16882289 17065618 18829721 19364845 19179125 14693519","No"
25855742,"10.1128/JVI.03156-14","Interaction between TIM-1 and NPC1 Is Important for Cellular Entry of Ebola Virus.","Makoto Kuroda, Daisuke Fujikura, Asuka Nanbo, Andrea Marzi, Osamu Noyori, Masahiro Kajihara, Junki Maruyama, Keita Matsuno, Hiroko Miyamoto, Reiko Yoshida, Heinz Feldmann, Ayato Takada",2015,"J. Virol.",TRUE,29,6.88112871136308,3.49174836367486,5.8,1.66,69.1,0.17,0.5,0.33,0.144337567297406,-0.25,0.25,FALSE,"","32109150 29338048 27147086 31638994 28045014 30441759 31732320 30893855 28483690 32522856 28167539 31648236 29511990 33052961 26509109 29593155 26861827 26875443 26003830 26487564 29411209 27640102 28710692 30615471 32541946 30010949 26923960 31810353 27406444","23084921 9990080 16571833 24478428 22039362 21501828 15220407 11967302 19641222 10092649 15007635 23702199 23233528 21866101 9405687 23555248 14585362 22238307 24131711 20219911 18082433 9525641 22395071 21987776 24122154 23698310 21987779 23288419 16051304 20862315 15383160 15958209 18566430 23035224 14638512 21866103 18414680 20886108 7844558 14990712 15831716 17442946 10479477 11160735 17368819 24738640 12050398 12502850 21536871 15479853","No"
20961186,"10.1515/CCLM.2011.003","Harmonization of free thyroid hormone tests: a mission impossible?","Giorgio Iervasi, Aldo Clerico",2011,"Clin. Chem. Lab. Med.",TRUE,8,3.67191697570346,2.12920495216694,0.888888888888889,0.42,22.5,1,0,0,0,1,0.75,FALSE,"","24937843 28189596 31912542 28245185 27333057 27329994 21679128 31526200","1307685 16840583 17126310 10487939 11468222 19114271 14725937 11444163 20395622 17439341 8448866 7923779 645767 19110971 20395624 1623599 2180687 20395623 19942151 20378766 15737023 12858311 1597014 19147729 11522272 16595820 10620577 17456290","No"
20961170,"10.1162/jocn.2010.21581","Spatial attention determines the nature of nonverbal number representation.","Daniel C Hyde, Justin N Wood",2011,"J Cogn Neurosci",TRUE,36,3.78186268954311,2.17494741380959,4,1.84,72.5,1,0,0,0,1,0.5,FALSE,"24267592","23167969 24039340 23420691 27879322 26689808 24267592 23933254 28197086 21909934 32038201 24639374 24353478 22266261 26385418 30618975 33000437 32152929 29549663 23355830 25463351 27683275 30095174 29132016 31696296 26439926 28261078 24632675 30778314 26447575 22144955 25224181 27747998 24198803 27423447 25883563 22727938","3153671 15504333 18578852 9636237 10890585 16359648 11933999 19380739 18254657 17958487 16866741 18385672 12893126 17803921 12535996 18164282 11848588 15720375 6460833 16139585 19899916 17227194 18399893 16771804 9448241 1511586 11245838 10594312 7803199 21399717 15242690 17214890 16683927 21223875 11697933 17678639 23964915 8121961 17761158 15486303 9784133 18752403 16260263 12485738 11689021 10652523 11340926 11426231 12930467 23972235 6886634","No"
25855731,"10.1128/JVI.00315-15","Molecular chaperone Hsp90 is a therapeutic target for noroviruses.","Surender Vashist, Luis Urena, Mariam B Gonzalez-Hernandez, Jayoung Choi, Alexis de Rougemont, Joana Rocha-Pereira, Johan Neyts, Seungmin Hwang, Christiane E Wobus, Ian Goodfellow",2015,"J. Virol.",TRUE,22,5.68254498875044,2.98477154678445,4.4,1.47,64.9,0.14,0.43,0.43,0,-0.285714285714286,0.05,FALSE,"","30483236 28990809 31751365 29875467 29686409 27264433 28374783 27187154 32661235 32060956 26881878 30584800 31621968 26258852 29530841 27736665 28901254 29212943 28780632 27957385 26945041 28602838","20637238 18680645 22520467 22154817 21295323 21173246 24696493 24922570 21505273 17121807 19176631 19740508 18528491 22951568 20575662 24583027 23209418 22626565 22915796 6710869 21871502 20224775 20864038 22787222 16698991 10945979 19864676 21068151 15688069 15761153 16465162 20651736 24319055 10655441 20832499 22792064 20375172 11707594 20027183 21228240 20979457 16394098 18789755 22222203 22933270 12176997 23602469 24199805 22183253 21698775 22535777 15562321 8627664 17350731 25378626 19150985 24225499 21516251 21994656 23876403 24243731 24227937 12857886 20053745 21840346 18783811 22558448 22071521 24706778 19697319 19073655 22654666 22002165 20161407 24316032 9815206 22939624 12624267 12948373 23986582 15209518 17622609 9581772 21144866 21945180 16860662 16835235 24789596 22150036 17234885","No"
25855727,"10.1128/JVI.00589-15","Temperature-Sensitive Mutants in the Influenza A Virus RNA Polymerase: Alterations in the PA Linker Reduce Nuclear Targeting of the PB1-PA Dimer and Result in Viral Attenuation.","Bruno Da Costa, Alix Sausset, Sandie Munier, Alexandre Ghounaris, Nadia Naffakh, Ronan Le Goffic, Bernard Delmas",2015,"J. Virol.",TRUE,11,5.67084723962221,2.97982363408889,2.2,0.74,39.2,0.12,0.38,0.5,-0.108253175473055,-0.3125,0.05,FALSE,"","26792748 30326610 28866238 32776651 27440882 30695536 27798704 30839917 27803181 32867106 30353004","12186883 25409151 22621130 19194459 20962084 19194458 17081640 12620793 1484872 17005651 19264657 6950380 15613301 15308710 20061134 17494067 9135141 21901097 8760421 25071209 22936969 8150274 23469251 15956611 18615018 22449422 16306596 19906916 20538599 7966557 21562121 11483758 22745253 7133998 2555175 9224927 22127214 18660801 18987140 8107244 12008925 20844191 22325937 23816991 10516084 25620561 25409142","No"
20961158,"10.1021/jp1028855","Ultrafast relaxation dynamics observed through time-resolved photoelectron angular distributions.","Julien Lecointre, Gareth M Roberts, Daniel A Horke, Jan R R Verlet",2010,"J Phys Chem A",TRUE,34,4.0214198484127,2.32211017467769,3.4,1.46,64.6,0,0,1,-0.866025403784439,-0.5,0.05,FALSE,"","28451374 25301059 26980306 24955934 24204191 21682320 28948280 25686152 23968065 28471670 26030180 29461530 22463527 22614441 27367260 28937696 24092279 27792360 24734261 31663558 29560245 22755609 26274076 21947027 23881504 23642262 30221282 21971531 27809535 24006992 32233436 26263111 32499507 26286406","","No"

                  </pre>
              </code>
          </div>
          <h2>Correct the test function + restore original format of data source</h2>
          <h3>Previous modified version</h3>
          <div class="codebg">
              <code>
                  <pre>
                  citing_id,cited_id
                    2140506,2942070
                    1523579,7097569
                    1509982,6501574
                    1968312,13673087
                    2330868,3958380
                    1854174,3037997
                    2038824,2494239
                    2373284,7189714
                    3591292,4092853
                    2368927,355650
                  </pre>
              </code>
 
          </div>
          <h3>Restored original version</h3>
          <div class="codebg">
          <code>
              <pre>
                    citing,referenced
                    2140506,2942070
                    1523579,7097569
                    1509982,6501574
                    1968312,13673087
                    2330868,3958380
                    1854174,3037997
                    2038824,2494239
                    2373284,7189714
                    3591292,4092853
                    2368927,355650
                  </pre>
              </code>
          </div>
          <h2>Test Function with corrections</h2>
          <div class="codebg">
              <code>
                  <pre>
                  import unittest
from index.coci.glob import process 
from os import sep, makedirs 
from os.path import exists  
from shutil import rmtree
from index.storer.csvmanager import CSVManager 
from index.noci.nationalinstituteofhealthsource import NationalInstitutHealthSource 
from csv import DictReader


class NOCITest(unittest.TestCase):

    def setUp(self): 
        self.input_file = "index%stest_data%snoci_dump%ssource.csv" % (sep, sep, sep) 
        self.citations = "index%stest_data%snoci_dump%scitations.csv" % (sep, sep, sep) 
    def test_citation_source(self):
        ns = NationalInstitutHealthSource(self.input_file) 
        new = []
        cit = ns.get_next_citation_data()
        while cit is not None:
            citing, cited, creation, timespan, journal_sc, author_sc = cit 
            new.append({
                "citing": citing,
                "cited": cited,
                "creation": "" if creation is None else creation, 
                "timespan": "" if timespan is None else timespan,
                "journal_sc": "no" if journal_sc is None else journal_sc,
                "author_sc": "no" if author_sc is None else author_sc
            })
            cit = ns.get_next_citation_data() 
        with open(self.citations) as f: 
            old = list(DictReader(f)) 

        self.assertEqual(new, old) 
                  </pre>
              </code>
          </div>
          
          <p></p>
          <h2>Develop the main function</h2>
          <h3>nationalinstitutehealthsource.py</h3>
          <div class="codebg">
              <code>
                  <pre>
                  from index.identifier.identifiermanager import IdentifierManager
from re import sub, match

class PMIDManager(IdentifierManager):
    def __init__(self):
        self.p="pmid:"
        super(PMIDManager, self).__init__()

    def is_valid(self, id_string):
        pmid = self.normalise(id_string)
        return pmid is not None and match("^[0-9]{1,7}$", pmid) and PMIDManager.__check_digit(pmid) #Ancore ^ $ per definire inizio e fine della stringa
    #exact function of check_digit?
    def normalise(self, id_string, include_prefix=False):
        try:
            pmid_string = sub("[^X0-9]", "", id_string.upper()) #re.sub(pattern, repl, string, count=0, flags=0) -- Return the string obtained by replacing the leftmost non-overlapping occurrences of pattern in string by the replacement repl. If the pattern isn’t found, string is returned unchanged.
            return "%s%s" % (self.p if include_prefix else "", pmid_string[:])  #is it required to use the separator here?
        except:  # Any error in processing the PMID will return None
            return None

@staticmethod
    def __check_digit(pmid):
    #don't know exaclty how to proceed: I only know that the format of the pmid is from 1 to 7 digits
                  
                  </pre>
              </code>
          </div>
          
          <iframe src="https://trinket.io/embed/python/e9f4db5ca5" width="100%" height="356" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>
          
          
          <h3>pmidmanager</h3>
          <div class="codebg">
              <code>
                  <pre>
                  from index.identifier.identifiermanager import IdentifierManager
from re import sub, match

class PMIDManager(IdentifierManager):
    def __init__(self):
        self.p="pmid:"
        super(PMIDManager, self).__init__()

    def is_valid(self, id_string):
        pmid = self.normalise(id_string)
        return pmid is not None and match("^[0-9]{1,7}$", pmid) and PMIDManager.__check_digit(pmid) #Ancore ^ $ per definire inizio e fine della stringa
    #exact function of check_digit?
    def normalise(self, id_string, include_prefix=False):
        try:
            pmid_string = sub("[^X0-9]", "", id_string.upper()) #re.sub(pattern, repl, string, count=0, flags=0) -- Return the string obtained by replacing the leftmost non-overlapping occurrences of pattern in string by the replacement repl. If the pattern isn’t found, string is returned unchanged.
            return "%s%s" % (self.p if include_prefix else "", pmid_string[:])  #is it required to use the separator here?
        except:  # Any error in processing the PMID will return None
            return None

@staticmethod
    def __check_digit(pmid):
    #don't know exaclty how to proceed: I only know that the format of the pmid is from 1 to 7 digits
                  </pre>
              </code>
          </div>
          
          <iframe src="https://trinket.io/embed/python/2ec315fe53" width="100%" height="356" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>
          
          
          <h2>Locally clone and launch OC index</h2>
          <p>OC Index locally cloned + NOCI files added.</p>
          <h2>Read Mail about mapping</h2>
          <h3>Kevin Boyack</h3>
          <p>The DOI-PMID mapping is not in iCite. (FALSE --> is in metadata --> forse l'hannoe estesa nel frattempo)</p>
          <p> Boyack built a mapping file from:</p> 
          <ol>
              <li><strong>PMC Europe's DOI-PMID-PMCID (csv) downloadable mapping file</strong>. Porblems: DOIs for old papers mapped to newer PMID.</li>
              <li>DOI-PMID pairs from PubMed (prob icite usa questo, essendo in nih che è responsabile di pubmed)</li>
          </ol>
          <p> Then, he identified by logic the best DOI-PMID matches. </p>
          <ol>
              <li>pairs that appear in both sources are the most reliable.</li>
              <li>for the remaining pairs, use first the ones from PubMed (that seem to be more reliable than PMC Europe's ones; then the ones from PMC-E. </li>
          </ol>
          <p>According to Boyack, <strong>once a DOI or PMID has been used, it is excluded from being used again</strong>: if a DOI-PMID pair exists in both datasets, any remaining pairs in either source containing those DOIs or PMIDs are removed. </p>
          <p>Errori nei due dataset di partenza, ci sono occorrenze di coppie molteplici. trovando una doppia coppia, cancella tutte le altre, dovendo essere un matching uno a uno</p>
          <p>N.B.:Several hundred thousand pairs are left over, as they are not unique to DOI or PMID: these are excluded entirely because there is no way to know which is correct. </p>
          <p> Boyack's DOI-PMID file: (<a href="https://www.dropbox.com/s/rl63f1pfhym8l3r/doi_pmid.txt.gz?dl=0"> https://www.dropbox.com/s/rl63f1pfhym8l3r/doi_pmid.txt.gz?dl=0</a>) –  The third column denotes the source of the DOI-PMID pair.</p>
          
          <h2>Issues</h2>
          <ol>
              <li><p>According to Boyack, <strong>once a DOI or PMID has been used, it is excluded from being used again</strong>: if a DOI-PMID pair exists in both datasets, any remaining pairs in either source containing those DOIs or PMIDs are removed. --> I don't fully get the sense of this sentence.</li>
              <li>Issues related to pmid manager (@staticmethod def __check_digit(pmid):)</li>
              <li>pmid manager: pmid_string = sub("[^X0-9]", "", id_string.upper()) #re.sub(pattern, repl, string, count=0, flags=0) -- Return the string obtained by replacing the leftmost non-overlapping occurrences of pattern in string by the replacement repl. If the pattern isn’t found, string is returned unchanged.
            return "%s%s" % (self.p if include_prefix else "", pmid_string[:])  #is it required to use the separator here?</li>
              <li></li>
          </ol>


      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingFour">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
          Week #4 (02-11-21)
        </button>
      </h5>
    </div>
    <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
      <div class="card-body">
          
        <h2>PMIDmanager</h2>
        <h3>Fix the second function developed last time following the DOIs example</h3>
        <p></p>
        <h2>PMIDmanager Test Case</h2>
        <h3>Develop a test case also for this latter function</h3>
        <p></p>
        <h2>Run Tests</h2>
        <h3>Check the correct functioning of the developed functions using their test cases</h3>
        <p></p>
        <h2>Overall Process</h2>
        <h3>Where do we need additional code to manage pubmedIDs?</h3>
        <p></p>
          
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingFive">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
          Week #5 (02-18-21)
        </button>
      </h5>
    </div>
    <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
      <div class="card-body">
        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingSix">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
          Week #6 
        </button>
      </h5>
    </div>
    <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#accordion">
      <div class="card-body">
        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
      </div>
    </div>
  </div>
</div>



  </body>
</html>
